## Node的特性

### Node的优点：

- 高并发实时性应用：比如为客户端提供 API，读取数据库。
- 适合I/O密集型应用：对于高并发的长连接，事件驱动模型比线程轻量得多
- 流式应用：比如客户端经常上传文件。
- 前后端分离。

### Node的缺点：

- 不适合CPU密集型应用；CPU密集型应用给Node带来的挑战主要是：由于JavaScript单线程的原因，如果有长时间运行的计算（比如大循环），将会导致CPU时间片不能释放，使得后续I/O无法发起
- 只支持单核CPU，不能充分利用CPU：但可以通过启动多个 Node.js 进程，各自监听一个端口，同时在最外层利用 Nginx 做负载均衡。

---

### Node如何做到高并发处理

> 一般来说，高并发的解决方案就是多线程模型，服务器为每个客户端请求分配一个线程，使用同步I/O，系统通过线程切换来弥补同步I/O调用的时间开销，比如Apache就是这种策略，由于I/O一般都是耗时操作，因此这种策略很难实现高性能，但非常简单，可以实现复杂的交互逻辑。

但是`Node`不一样，`Node`使用了单线程模型来处理请求，那单线程的情况下还如何处理高并发？

​	`Node`使用的是非阻塞I/O来实现并发，我们都知道关于`Node`的一个很著名的例子，饭堂打饭的一个例子。`Node`通过事件驱动的机制来实现到高并发的。当一个请求到达时便将它推入事件队列，然后继续接收其他请求，就像食堂点菜，然后当主线程空闲时便可以处理队列中的任务和返回响应结果，这样做前面的请求甚至不会阻塞到后续的请求，达到一个高并发的目的。后续则通过`Node`的`event loop`来进行请求的处理。而进行请求处理的过程如果涉及到文件I/O这种长时间的处理，Node也封装了`file`模块来利用底层的线程池实现异步文件I/O，保证文件I/O的过程也是异步的，不会阻塞到主线程的执行，所以才能达到高并发。

> 而且通过事件循环处理这些请求，从而避开了创建、销毁线程以及在线程间切换所需的开销和复杂性。

​	其实我们可以看到`Node`提供给我们的API有很多很多都带有回调函数，这就是`Node`的最基本的编程思想：异步。因为`Node`处理网络请求的过程是单线程的，我们只能在这个`onrequest`的回调函数上进行我们所有的请求处理，所以我们必须注意到我们所有的耗时操作（类似I/O）都需要使用模块进行异步处理，为的是不把主线程阻塞到，因为阻塞主线程等于阻塞其他用户对服务器的访问。`Node`也是靠着这各种异步的方式来处理网络I/O的高并发的。emmm...文件I/O的异步处理还是通过线程池实现的。



如果有大量 CPU 密集型任务，那就不要用`Node`了。



**Reference：**

- [为什么nodejs支持高并发、非阻塞](http://wearejq.github.io/2015/07/15/nodejs/)
- [浅谈 Node.js 单线程模型](http://web.jobbole.com/91687/)
- [为什么要用Node.JS](https://bestswifter.com/nodejs)
- [Node.js的evnet loop](https://github.com/creeperyang/blog/issues/26)